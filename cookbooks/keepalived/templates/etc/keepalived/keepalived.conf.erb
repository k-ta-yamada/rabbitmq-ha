! Configuration File for keepalived

global_defs {
    notification_email {
        <%- @global_defs[:notification_email].each do |address| -%>
        <%= address %>
        <%- end -%>
    }
    notification_email_from <%= @global_defs[:notification_email_from] %>
    smtp_server             <%= @global_defs[:smtp_server] %>
    smtp_connect_timeout    <%= @global_defs[:smtp_connect_timeout] %>
    router_id               <%= @global_defs[:router_id] %>
}

vrrp_script <%= @vrrp_script[:name] %> {
    script   <%= @vrrp_script[:script] %>
    interval <%= @vrrp_script[:interval] %>
    weight   <%= @vrrp_script[:weight] %>
}

vrrp_instance <%= @vrrp_instance[:name] %> {
    interface         <%= @vrrp_instance[:interface] %>
    state             <%= @vrrp_instance[:state] %>
    virtual_router_id <%= @vrrp_instance[:virtual_router_id] %>
    priority          <%= @vrrp_instance[:priority] %>

    track_interface {
        <%- @vrrp_instance[:track_interface].each do |address| -%>
        <%= address %>
        <%- end -%>
    }
    virtual_ipaddress {
        <%- @vrrp_instance[:virtual_ipaddress].each do |h| -%>
        <%= h[:address] %> dev <%= h[:interface] %>
        <%- end -%>
    }
    track_script {
        <%- @vrrp_instance[:track_script].each do |script| -%>
        <%= script %>
        <%- end -%>
    }
    unicast_src_ip <%= @unicast_src_ip %>
    unicast_peer {
        <%- @unicast_peer.each do |address| -%>
        <%= address %>
        <%- end -%>
    }
}
